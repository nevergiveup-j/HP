/* @Github URL: https://github.com/nevergiveup-j/HP/tree/master/share */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){"use strict";function c(c,d){this.$elem=c,this.$elem.length&&(this.options=a.extend(!0,{},b,d||{}),this.options.social=d.social||b.social,this.init())}var d,e,b={social:["weibo","tqq","qzone","renren"],theme:"icon",shareConfig:{title:document.title,url:window.location.href,pic:"",summary:"",desc:"",searchPic:!0,source:{appkey:{weibo:"",tqq:""},ralateUid:{weibo:"",tqq:""},siteName:""}},buttons:{weibo:{text:"新浪微博",className:"weibo",url:"http://service.weibo.com/share/share.php?url={url}&title={title}&pic={pic}&appkey={appkey}&ralateUid={ralateUid}&searchPic={searchPic}"},tqq:{text:"腾讯微博",className:"tqq",url:"http://v.t.qq.com/share/share.php?url={url}&title={title}&pic={pic}&appkey={appkey}"},qzone:{text:"QQ空间",className:"qzone",url:"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url={url}&title={title}&pics={pic}&summary={summary}&site={site}"},renren:{text:"人人网",className:"renren",url:"http://widget.renren.com/dialog/share?link={url}&title={title}&pic={pic}"},qq:{text:"QQ",className:"qq",url:"http://connect.qq.com/widget/shareqq/index.html?url={url}&title={title}&pics={pic}&summary={summary}&desc={desc}&site={site}"},weixin:{text:"微信",className:"weixin",url:""},douban:{text:"豆瓣",className:"douban",url:"http://www.douban.com/share/service?href={url}&name={title}&text={summary}"},twitter:{text:"twitter",className:"twitter",url:"https://twitter.com/share?url={url}&text={title}"},facebook:{text:"facebook",className:"facebook",url:"http://www.facebook.com/sharer.php?u={url}&t={title}"}}};return c.prototype={version:"1.0",init:function(){var a=this;a.render(),a.$list=a.$elem.find(".btn-share"),a.bind()},render:function(){var e,a=this,b=a.options.social,c=null,d=['<div class="hp-shareTo-inner">'];for(e in b)e=b[e],c=a.options.buttons[e],"undefined"!=typeof c&&d.push('<a href="javascript:" data-type="'+e+'" class="btn-share btn-share-'+c.className+'" title="'+c.text+'">'+c.text+"</a>");d.push("</div>"),a.$elem.append(d.join(""))},bind:function(){var b=this,c=null,e=b.options.shareConfig;e.buttons=b.options.buttons,b.$list.bind("click",function(){c=a(this).data("type"),new d(c,e)})}},d=function(c,d){function q(a,b){var d="";return d="tqq"===c?b:a}var g,h,i,j,k,l,m,n,p,r,s,t,u,v,w,f=b.shareConfig;f.buttons=b.buttons,g=a.extend(!0,{},f,d||{}),h=encodeURIComponent(g.title),i=encodeURIComponent(g.url),j=g.pic,k=encodeURIComponent(g.summary),l=encodeURIComponent(g.desc),m=encodeURIComponent(g.source.site),n=q(g.source.appkey.weibo,g.source.appkey.tqq),q(g.source.ralateUid.weibo,g.source.ralateUid.tqq),"undefined"!=typeof g.buttons[c]&&(p=j.split("||"),p.length>1&&"weibo"!==c&&(j=p[0]),j=encodeURIComponent(j),r=600,s=500,t=(window.screen.availHeight-30-s)/2,u=(window.screen.availWidth-10-r)/2,v="","qq"!==c&&(v="scrollbars=no,width="+r+",height="+s+",left="+u+",top="+t+",status=no,resizable=yes"),w=g.buttons[c]["url"].replace("{url}",i).replace("{title}",h).replace("{pic}",j).replace("{appkey}",n).replace("{ralateUid}",g.ralateUid).replace("{summary}",k).replace("{site}",m).replace("{desc}",l).replace("{searchPic}",g.searchPic),"weixin"===c?(e.init({title:"打开微信“扫一扫”<br />打开网页后点击屏幕右上角分享按钮",content:'<p style="width:162px;height:162px;margin:0 auto;text-align:center;padding:20px 0 45px;" id="J_qrcodeWeixin"></p>'}),new QRCode("J_qrcodeWeixin",{text:g.url,width:162,height:162})):window.open(w,c,v))},e={init:function(b){var c=this;c.options=b,c.T_RESIZE=null,c.$win=a(window),c.$body=a("body"),c.render(),c.bind()},render:function(){var b=this,c=['<div class="hp-share-mask" id="J_hp_share_mask"></div>','<div id="J_hp_popShare" class="hp-pop-share">','<div class="hd">',"<h3>",b.options.title,"</h3>",'<a href="javascript:" class="btn-close">×</a>',"</div>",'<div class="bd">',b.options.content,"</div>","</div>"].join("");b.$body.append(c),b.$mask=a("#J_hp_share_mask"),b.$popLayer=a("#J_hp_popShare"),b.$btnClose=b.$popLayer.find(".btn-close"),b.setResizeSize()},bind:function(){var b=this;a(document).bind("keydown","esc",function(){b.hide()}),b.$mask.bind("click",function(){b.hide()}),b.$btnClose.bind("click",function(){b.hide()}),b.$win.bind("resize",function(){b.T_RESIZE=setTimeout(function(){b.setResizeSize()},200)})},hide:function(){var b=this;clearTimeout(b.T_RESIZE),a(document).unbind(),b.$mask.unbind().fadeOut("fast",function(){a(this).remove()}),b.$popLayer.addClass("voice-pop-in-share").fadeOut("fast",function(){a(this).remove()})},setResizeSize:function(){var a=this,b=Math.max(document.body.clientHeight,document.body.offsetHeight,document.documentElement.clientHeight),c=a.getPosCenter();a.$mask.css({display:"block",width:"100%",height:b}),a.$popLayer.css({position:"absolute",top:c.top,left:c.left}).show()},getPosCenter:function(){var a=this,b=a.$win.width(),c=a.$win.height(),d=a.$win.scrollTop(),e=a.$win.scrollLeft(),f=a.$popLayer.width(),g=300,h=d+(c-g)/2,i=e+(b-f)/2;return{top:h,left:i,viewWidth:b}}},a.extend({shareAPI:function(a,b){new d(a,b)}}),a.shareAPI.version="1.0.1",a.fn.share=function(b){return this.each(function(){var d=a(this);new c(d,b)})},{ShareAPI:d,share:c}});